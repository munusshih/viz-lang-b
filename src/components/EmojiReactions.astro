---
interface EmojiDef {
  id: string;
  label: any;
  text: string;
}

interface Props {
  pageKey: string;
}

import Flame from "@lucide/astro/icons/flame";
import Brain from "@lucide/astro/icons/brain";
import Briefcase from "@lucide/astro/icons/briefcase";
import BookOpen from "@lucide/astro/icons/book-open";
import CircleQuestionMark from "@lucide/astro/icons/circle-question-mark";

const { pageKey } = Astro.props;

const emojiDefs: EmojiDef[] = [
  { id: "inspired", label: Flame, text: "Inspired" },
  { id: "brainy", label: Brain, text: "Brainy" },
  { id: "useful", label: Briefcase, text: "Useful" },
  { id: "informative", label: BookOpen, text: "Informative" },
  { id: "confused", label: CircleQuestionMark, text: "Confused" },
];
---

<section class="emoji-reactions" data-emoji-reactions data-page-key={pageKey}>
  <p class="emoji-reactions__label">
    How did this week's content land for you?
  </p>
  <div class="emoji-reactions__list">
    {
      emojiDefs.map((emoji) => {
        const Icon = emoji.label;
        return (
          <button
            type="button"
            class="emoji-reactions__button"
            data-emoji-id={emoji.id}
            aria-label={`React with ${emoji.text}`}
          >
            <span class="emoji-reactions__emoji">
              <Icon
                size={18}
                stroke-width="1.8"
                class="emoji-reactions__icon"
                aria-hidden="true"
              />
            </span>
            <span class="emoji-reactions__text">{emoji.text}</span>
            <span class="emoji-reactions__count" data-count>
              0
            </span>
          </button>
        );
      })
    }
  </div>
</section>

<script>
  import { initEmojiReactions } from "../scripts/emoji-reactions.js";

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", () => initEmojiReactions());
  } else {
    initEmojiReactions();
  }
</script>

<style>
  .emoji-reactions {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin: 0 auto 1.5rem;
    border-top: 1px solid var(--color-accent);
    padding-top: 2rem;
    width: 100%;
    font-family: "Comfortaa", sans-serif;
  }

  .emoji-reactions__list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .emoji-reactions__button {
    display: inline-flex;
    position: relative;
    align-items: center;
    gap: 0.4rem;
    transition:
      transform 120ms ease,
      box-shadow 120ms ease;
    cursor: pointer;
    border: 1px solid var(--color-accent);
    border-radius: 999px;
    padding: 0.35rem 0.7rem;
  }

  .emoji-reactions__button:hover {
    transform: translateY(-1px);
  }

  .emoji-reactions__button.is-clicked {
    transform: none;
    background: var(--color-accent);
    color: var(--color-white);
  }

  .emoji-reactions__emoji {
    display: inline-flex;
  }

  .emoji-reactions__icon {
    width: 18px;
    height: 18px;
  }

  .emoji-reactions__text {
    opacity: 0.8;
    font-weight: 600;
    font-size: 0.85rem;
  }

  .emoji-reactions__count {
    font-weight: 700;
    font-size: 0.85rem;
  }
</style>
